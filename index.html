<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title> Moody Weather</title>

  <link rel="stylesheet" type="text/css" href="assets/css/style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">

</head>

<body>


  <div class="container">
    <div class="row">
      <div class="col s12" </div>
        <div class="card-panel teal lighten-2" </div>
          <span class="black-text text-darken-2" </span>
            <h1 class="center-align">Moody Weather</h1>
        </div>
      </div>


      <div class="container1">
        <div class="panel panel-primary">
          <div class="panel-heading">
            <h3 class="panel-title">Weather Search</h3>

          </div>
          <div class="row">
            <div class="col s6">
              <form action="/action_page.php">
                <label for="weatherInput"></label>
                <input type="text" id="weatherInput" placeholder="Search .." name="search">
                <button type="submit" class="btn waves-effect waves-light btn" id="submitBtn">Submit</button>
              </form>
            </div>
          </div>
        </div>
      </div>




      <div class="container2">
        <div class="panel panel-primary">
          <div class="panel-heading">Results</div>
          <div class="panel-body">
            <div class="container-fluid">
              <h3>Search results</h3>
              <div class="row">
                <div class="col s12 card-panel teal lighten-3 z-depth-2" id="weatherView">
                  <span class="black-text text-darken-2 ">Weather Condition</span>
                </div>
                <div class="col s6 card-panel teal lighten-2 z-depth-2" id="tempView">
                  <span class="black-text text-darken-2">Temperature</span>
                </div>
                <div class="col s6 card-panel teal lighten-2 z-depth-8" id="movieLog">
                  <span class="black-text text-darken-2">Movies!</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>



      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
      <script>
        // var wordBank = [{
        //   clear: ['sunny'],
        //   snow : ['light snow','snowy'],
        //   cloudy: ['Scattered Clouds', 'Overcast']
        // }];
        // var weatherWord = {clear,snow,cloudy}; 
        // var searchTerm = "";
        // var x;
        // for (x in person) {
        //     text += person[x] + " ";
        // }
        $("#submitBtn").on("click", function (event) {
          event.preventDefault();
          var city = $("#weatherInput").val();
          var queryURL = "http://api.wunderground.com/api/397251ff2fe9bd69/conditions/q/" + city + ".json";
          var tempf = ['current_observation'];
          var weatherView = $("#weatherView");
          var weatherData = $("#weatherView").val();
          $.ajax({
            url: queryURL,
            method: "GET"
          }).done(function (response) {
            $("#weatherInput").val('');
            var typeOfWeather = response.current_observation.weather;
            weatherView.text(JSON.stringify(typeOfWeather));
            $("#tempView").text(JSON.stringify(response.current_observation.temp_f));
            weatherData = weatherData + typeOfWeather;
            console.log(weatherData);
            console.log(response);
            console.log(response.current_observation.temp_f);
            movieAPI(weatherData);
          })
          function movieAPI(weatherType) {
            console.log(weatherType);
            var queryURL2 = "http://www.omdbapi.com/?i=tt3896198&s=" + weatherType + "&apikey=869ed286"; //poster NA
            $.ajax({
              url: queryURL2,
              method: "GET"
            }).then(function (response) {


              if (response.Response == "False") {
                alert("PICK BETTER WEATHER!");
              } else {
                for (var i = 0; i < 2; i++) {
                  console.log(queryURL2);
                  console.log(response);
                  $("#weatherInput").text(JSON.stringify(response));
                  //$("#movieLog").text(JSON.stringify(response.Title + response.Rated));
                  console.log(queryURL2);
                  var movieDiv = $("<div class='movie'>")
                  var title = response.Search[i].Title;
                  var titleDOM = $("<p>").text("Title: " + title);
                  movieDiv.append(titleDOM);

                  var year = response.Search[i].Year;
                  var ratingDOM = $("<p>").text("Rating: " + year);
                  var imgURL = response.Search[i].Poster;
                  //if statement
                  var poster = $("<img>").attr("src", imgURL);
                  movieDiv.append(poster);
                  $("#movieLog").prepend(movieDiv);
                }
              };
            });
          }
          //clearing the div with each search. 
          //chaninging search from weather posters NA 
          // if poster = NA 
          // then replace with placeholder or image or alter image. 
          // extra: log in, favortie, genre. etc. 
          // var weatherData = $("#weatherView").val();
          // var queryURL2= "http://www.omdbapi.com/?i=tt3896198&s="+weatherData+"&apikey=869ed286";
          // $.ajax({
          //     url: queryURL2,
          //     method: "GET"
          //     }).done(function(response) {
          //       console.log(response);
          //       $("#weatherInput").text(JSON.stringify(response));
          //       $("#movieLog").text(JSON.stringify(response));
          //       console.log(weatherData);
          //     });
          // console.log(queryURL2);
        })
      </script>

</body>
<footer class="page-footer">
  <div class="container">
    <div class="row">
      <div class="col l6 s12">
        <h5 class="white-text">Footer Content</h5>
        <p class="grey-text text-lighten-4">You can use rows and columns here to organize your footer content.</p>
      </div>
      <div class="col l4 offset-l2 s12">
        <h5 class="white-text">Links</h5>
        <ul>
          <li>
            <a class="grey-text text-lighten-3" href="#!">Link 1</a>
          </li>
          <li>
            <a class="grey-text text-lighten-3" href="#!">Link 2</a>
          </li>
          <li>
            <a class="grey-text text-lighten-3" href="#!">Link 3</a>
          </li>
        </ul>
      </div>
    </div>
  </div>
  <div class="footer-copyright">
    <div class="container">
      Â© 2018 Copyright Text
      <a class="grey-text text-lighten-4 right" href="#!">More Links</a>
    </div>
  </div>
</footer>

</html>